<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>luckyLL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
      color: #fff;
      font-family: -apple-system,BlinkMacSystemFont,"Helvetica Neue",Arial,sans-serif;
    }
    #fireworks-root {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at bottom, #001020 0, #000 50%, #000 100%);
    }
    #fireworksCanvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
    }
    #controls {
      position: absolute;
      left: 50%;
      bottom: 6vh;
      transform: translateX(-50%);
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.55);
      box-shadow: 0 0 25px rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
    }
    #textInput {
      min-width: 220px;
      max-width: 320px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(0, 0, 0, 0.4);
      color: #fff;
      outline: none;
    }
    #textInput::placeholder {
      color: rgba(255, 255, 255, 0.55);
    }
    #launchButton {
      padding: 8px 18px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #ffd54f, #ff7043);
      color: #000;
      font-weight: 600;
      cursor: pointer;
      letter-spacing: 1px;
    }
    #launchButton:active {
      transform: translateY(1px);
      box-shadow: 0 0 0 rgba(0, 0, 0, 0.2);
    }
  </style>
  
    
</head>

<body>
  <div id="fireworks-root">
    <canvas id="fireworksCanvas"></canvas>
    <div id="controls">
      <input id="textInput" type="text" maxlength="12" placeholder="输入名字，按回车或点发射">
      <button id="launchButton">发射烟花</button>
    </div>
  </div>
  <script>
  (function() {
    var canvas = document.getElementById("fireworksCanvas");
    if (!canvas) return;
    var ctx = canvas.getContext("2d");
    var dpr = window.devicePixelRatio || 1;
    var fireworks = [];
    var particles = [];
    var textParticles = [];
    var lastLaunch = 0;
    function rnd() { return Math.random(); }
    function now() { return (window.performance && performance.now) ? performance.now() : Date.now(); }
    function resize() {
      var w = window.innerWidth;
      var h = window.innerHeight;
      canvas.style.width = w + "px";
      canvas.style.height = h + "px";
      canvas.width = w * dpr;
      canvas.height = h * dpr;
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    function randomColor() {
      var colors = ["#ffd54f","#ffb74d","#ff8a65","#4fc3f7","#81c784","#ba68c8","#fff176"];
      return colors[(colors.length * rnd()) | 0];
    }
    function spawnFirework() {
      var w = canvas.width / dpr;
      var h = canvas.height / dpr;
      fireworks.push({
        x: w * (0.1 + 0.8 * rnd()),
        y: h + 10,
        targetY: h * (0.2 + 0.3 * rnd()),
        speed: 4 + 2 * rnd(),
        color: randomColor(),
        exploded: false
      });
    }
    function explode(fw) {
      var count = 80 + (rnd() * 40) | 0;
      var baseSpeed = 1.5 + rnd() * 1.5;
      for (var i = 0; i < count; i++) {
        var angle = (Math.PI * 2 * i) / count;
        var speed = baseSpeed + rnd() * 1.2;
        particles.push({
          x: fw.x,
          y: fw.targetY,
          vx: Math.cos(angle) * speed,
          vy: Math.sin(angle) * speed,
          alpha: 1,
          color: fw.color,
          life: 120 + (rnd() * 60) | 0
        });
      }
      for (var j = 0; j < 30; j++) {
        particles.push({
          x: fw.x,
          y: fw.targetY,
          vx: (rnd() - 0.5) * 0.6,
          vy: (rnd() - 0.5) * 0.6,
          alpha: 1,
          color: "#ffffff",
          life: 30 + (rnd() * 20) | 0
        });
      }
    }
    function createText(text) {
      if (!text) return;
      var maxLen = 10;
      if (text.length > maxLen) text = text.slice(0, maxLen);
      var w = canvas.width / dpr;
      var h = canvas.height / dpr;
      var offCanvas = document.createElement("canvas");
      offCanvas.width = w;
      offCanvas.height = h;
      var off = offCanvas.getContext("2d");
      off.clearRect(0, 0, w, h);
      var fontSize = Math.min(w / (text.length * 0.8), h * 0.3);
      off.fillStyle = "#ffffff";
      off.textAlign = "center";
      off.textBaseline = "middle";
      off.font = "bold " + fontSize + "px sans-serif";
      off.fillText(text, w / 2, h / 2);
      var step = Math.max(4, Math.floor(fontSize / 18));
      var data = off.getImageData(0, 0, w, h).data;
      var points = [];
      for (var y = 0; y < h; y += step) {
        for (var x = 0; x < w; x += step) {
          var idx = (y * w + x) * 4 + 3;
          if (data[idx] > 128) points.push({ x: x, y: y });
        }
      }
      if (!points.length) return;
      points.sort(function(a, b){ return a.x === b.x ? a.y - b.y : a.x - b.x; });
      textParticles = [];
      var total = points.length;
      var totalWriteTime = 2600;
      var startTime = now();
      for (var i2 = 0; i2 < points.length; i2++) {
        var p = points[i2];
        var delay = (i2 / total) * totalWriteTime;
        textParticles.push({
          x: w * (0.2 + 0.6 * rnd()),
          y: h + rnd() * 40,
          tx: p.x,
          ty: p.y,
          startTime: startTime + delay,
          duration: 900,
          color: randomColor(),
          done: false
        });
      }
    }
    function updateTextParticles(t) {
      for (var i = textParticles.length - 1; i >= 0; i--) {
        var p = textParticles[i];
        if (p.done) {
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.tx, p.ty, 1.4, 0, Math.PI * 2);
          ctx.fill();
          continue;
        }
        var dt = (t - p.startTime) / p.duration;
        if (dt < 0) continue;
        if (dt >= 1) {
          p.done = true;
          p.x = p.tx;
          p.y = p.ty;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, 1.6, 0, Math.PI * 2);
          ctx.fill();
          continue;
        }
        var ease = dt;
        p.x = p.x + (p.tx - p.x) * ease;
        p.y = p.y + (p.ty - p.y) * ease;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 1.6, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    function tick() {
      var t = now();
      var w = canvas.width / dpr;
      var h = canvas.height / dpr;
      ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
      ctx.fillRect(0, 0, w, h);
      if (t - lastLaunch > 700 + rnd() * 600) {
        spawnFirework();
        lastLaunch = t;
      }
      for (var i = fireworks.length - 1; i >= 0; i--) {
        var fw = fireworks[i];
        fw.y -= fw.speed;
        ctx.fillStyle = fw.color;
        ctx.beginPath();
        ctx.arc(fw.x, fw.y, 2.5, 0, Math.PI * 2);
        ctx.fill();
        if (!fw.exploded && fw.y <= fw.targetY) {
          fw.exploded = true;
          explode(fw);
          fireworks.splice(i, 1);
        }
      }
      for (var j = particles.length - 1; j >= 0; j--) {
        var p = particles[j];
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.02;
        p.alpha -= 1 / p.life;
        if (p.alpha <= 0) {
          particles.splice(j, 1);
          continue;
        }
        ctx.globalAlpha = p.alpha;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
        ctx.fill();
        ctx.globalAlpha = 1;
      }
      if (textParticles.length) updateTextParticles(t);
      requestAnimationFrame(tick);
    }
    function bindControls() {
      var input = document.getElementById("textInput");
      var button = document.getElementById("launchButton");
      if (!input || !button) return;
      function trigger() {
        var value = input.value.trim();
        if (!value) value = input.getAttribute("placeholder") || "";
        createText(value);
      }
      button.addEventListener("click", trigger);
      input.addEventListener("keydown", function(e) {
        if (e.key === "Enter" || e.keyCode === 13) trigger();
      });
    }
    window.addEventListener("resize", resize);
    resize();
    bindControls();
    tick();
  })();
  </script>
</body>
</html>
