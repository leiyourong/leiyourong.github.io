<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>luckyLL</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
      color: #fff;
      font-family: -apple-system,BlinkMacSystemFont,"Helvetica Neue",Arial,sans-serif;
    }
    #fireworks-root {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at bottom, #001020 0, #000 50%, #000 100%);
    }
    #fireworksCanvas {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
    }
    #controls {
      position: absolute;
      left: 50%;
      bottom: 6vh;
      transform: translateX(-50%);
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.55);
      box-shadow: 0 0 25px rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
    }
    #textInput {
      min-width: 220px;
      max-width: 320px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(0, 0, 0, 0.4);
      color: #fff;
      outline: none;
    }
    #textInput::placeholder {
      color: rgba(255, 255, 255, 0.55);
    }
    #launchButton {
      padding: 0;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.25);
      background: radial-gradient(circle at 30% 30%, #ffe082, #ff7043 60%, #7c4dff 100%);
      color: #fff;
      cursor: pointer;
      letter-spacing: 1px;
      width: 42px;
      height: 42px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.4), inset 0 0 12px rgba(255,255,255,0.3);
    }
    #launchButton:active {
      transform: translateY(1px);
      box-shadow: 0 0 0 rgba(0, 0, 0, 0.2);
    }
    #settings {
      position: absolute;
      top: 16px;
      right: 16px;
      z-index: 10;
    }
    #settingsToggle {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: none;
      background: rgba(255,255,255,0.12);
      color: #fff;
      cursor: pointer;
      font-size: 18px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(6px);
    }
    #settingsPanel {
      position: absolute;
      top: 52px;
      right: 0;
      min-width: 280px;
      padding: 12px 14px;
      border-radius: 12px;
      background: rgba(0,0,0,0.7);
      color: #fff;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      backdrop-filter: blur(10px);
      display: none;
    }
    #settingsPanel h4 {
      font-size: 14px;
      margin: 6px 0 8px;
      font-weight: 600;
      color: #fff;
    }
    .row {
      margin-bottom: 10px;
    }
    .palette {
      display: grid;
      grid-template-columns: repeat(5, 26px);
      gap: 8px;
    }
    .chip {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      border: 2px solid rgba(255,255,255,0.25);
      cursor: pointer;
    }
    .chip.selected {
      border-color: #fff;
      box-shadow: 0 0 0 2px rgba(255,255,255,0.2);
    }
    .shape-group {
      display: flex;
      gap: 12px;
      align-items: center;
    }
    .shape-group label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      font-size: 13px;
    }
    .speed-row {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    #speedRange {
      width: 160px;
    }
    #speedLabel {
      font-size: 12px;
      color: #ddd;
      min-width: 40px;
      text-align: right;
    }
  </style>
  
    
</head>

<body>
  <div id="fireworks-root">
    <canvas id="fireworksCanvas"></canvas>
    <div id="controls">
      <input id="textInput" type="text" maxlength="12" placeholder="ËæìÂÖ•ÂêçÂ≠óÔºåÊåâÂõûËΩ¶ÊàñÁÇπÂèëÂ∞Ñ">
      <button id="launchButton" title="ÂèëÂ∞ÑÁÉüËä±">üöÄ</button>
    </div>
    <div id="settings">
      <button id="settingsToggle" title="ËÆæÁΩÆ">‚öôÔ∏è</button>
      <div id="settingsPanel">
        <div class="row">
          <h4>ÈÄüÂ∫¶</h4>
          <div class="speed-row">
            <input id="speedRange" type="range" min="50" max="200" value="100">
            <span id="speedLabel">x1.00</span>
          </div>
        </div>
        <div class="row">
          <h4>È¢úËâ≤ÔºàÂ§öÈÄâÔºâ</h4>
          <div class="palette" id="colorPalette">
            <div class="chip selected" data-color="#ffd54f" style="background:#ffd54f"></div>
            <div class="chip selected" data-color="#ffb74d" style="background:#ffb74d"></div>
            <div class="chip selected" data-color="#ff8a65" style="background:#ff8a65"></div>
            <div class="chip selected" data-color="#4fc3f7" style="background:#4fc3f7"></div>
            <div class="chip selected" data-color="#81c784" style="background:#81c784"></div>
            <div class="chip selected" data-color="#ba68c8" style="background:#ba68c8"></div>
            <div class="chip selected" data-color="#fff176" style="background:#fff176"></div>
            <div class="chip selected" data-color="#f06292" style="background:#f06292"></div>
            <div class="chip selected" data-color="#64b5f6" style="background:#64b5f6"></div>
            <div class="chip selected" data-color="#a5d6a7" style="background:#a5d6a7"></div>
          </div>
        </div>
        <div class="row">
          <h4>ÁÉüËä±ÂΩ¢Âºè</h4>
          <div class="shape-group">
            <label><input type="radio" name="shape" value="circle" checked> ÂúÜÂΩ¢</label>
            <label><input type="radio" name="shape" value="heart"> Áà±ÂøÉ</label>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
  (function() {
    var canvas = document.getElementById("fireworksCanvas");
    if (!canvas) return;
    var ctx = canvas.getContext("2d");
    var dpr = window.devicePixelRatio || 1;
    var fireworks = [];
    var particles = [];
    var textParticles = [];
    var lastLaunch = 0;
    var config = {
      speed: 1.0,
      palette: ["#ffd54f","#ffb74d","#ff8a65","#4fc3f7","#81c784","#ba68c8","#fff176","#f06292","#64b5f6","#a5d6a7"],
      selectedColors: null,
      shape: "circle"
    };
    function rnd() { return Math.random(); }
    function now() { return (window.performance && performance.now) ? performance.now() : Date.now(); }
    function resize() {
      var w = window.innerWidth;
      var h = window.innerHeight;
      canvas.style.width = w + "px";
      canvas.style.height = h + "px";
      canvas.width = w * dpr;
      canvas.height = h * dpr;
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
    }
    function randomColor() {
      var base = (config.selectedColors && config.selectedColors.length) ? config.selectedColors : config.palette;
      return base[(base.length * rnd()) | 0];
    }
    function spawnFirework() {
      var w = canvas.width / dpr;
      var h = canvas.height / dpr;
      fireworks.push({
        x: w * (0.1 + 0.8 * rnd()),
        y: h + 10,
        targetY: h * (0.2 + 0.3 * rnd()),
        speed: (4 + 2 * rnd()) * config.speed,
        color: randomColor(),
        exploded: false
      });
    }
    function explode(fw) {
      var count, baseSpeed;
      if (config.shape === "heart") {
        count = 180;
        baseSpeed = 0.5 * config.speed;
        var minDim = Math.min(canvas.width / dpr, canvas.height / dpr);
        var scale = Math.max(2.0, Math.min(3.6, minDim / 180));
        for (var i = 0; i < count; i++) {
          var t = (Math.PI * 2 * i) / count;
          var hx = Math.pow(Math.sin(t), 3);
          var hy = 0.8125 * Math.cos(t) - 0.3125 * Math.cos(2 * t) - 0.125 * Math.cos(3 * t) - 0.0625 * Math.cos(4 * t);
          var dx = hx * scale;
          var dy = -hy * scale;
          var jitter = 0.15;
          var vx = dx * (1.2 + rnd() * 0.3) + (rnd() - 0.5) * jitter;
          var vy = dy * (1.2 + rnd() * 0.3) + (rnd() - 0.5) * jitter;
          particles.push({
            x: fw.x,
            y: fw.targetY,
            vx: vx * baseSpeed,
            vy: vy * baseSpeed,
            alpha: 1,
            color: fw.color,
            life: 120 + (rnd() * 60) | 0
          });
        }
      } else {
        count = 80 + (rnd() * 40) | 0;
        baseSpeed = (1.5 + rnd() * 1.5) * config.speed;
        for (var i2 = 0; i2 < count; i2++) {
          var angle = (Math.PI * 2 * i2) / count;
          var speed = baseSpeed + rnd() * 1.2;
          particles.push({
            x: fw.x,
            y: fw.targetY,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            alpha: 1,
            color: fw.color,
            life: 120 + (rnd() * 60) | 0
          });
        }
      }
      for (var j = 0; j < 30; j++) {
        particles.push({
          x: fw.x,
          y: fw.targetY,
          vx: (rnd() - 0.5) * 0.6,
          vy: (rnd() - 0.5) * 0.6,
          alpha: 1,
          color: "#ffffff",
          life: 30 + (rnd() * 20) | 0
        });
      }
    }
    function createText(text) {
      if (!text) return;
      var maxLen = 10;
      if (text.length > maxLen) text = text.slice(0, maxLen);
      var w = canvas.width / dpr;
      var h = canvas.height / dpr;
      var offCanvas = document.createElement("canvas");
      offCanvas.width = w;
      offCanvas.height = h;
      var off = offCanvas.getContext("2d");
      off.clearRect(0, 0, w, h);
      var margin = Math.floor(w * 0.06);
      var fontSize = Math.min(w / (text.length * 0.8), h * 0.28);
      off.fillStyle = "#ffffff";
      off.textAlign = "center";
      off.textBaseline = "middle";
      var measure;
      do {
        off.font = "bold " + fontSize + "px sans-serif";
        measure = off.measureText(text);
        if (measure.width > (w - margin * 2)) {
          fontSize -= 2;
          if (fontSize < 18) break;
        } else {
          break;
        }
      } while (true);
      off.fillText(text, w / 2, h / 2);
      var step = Math.max(4, Math.floor(fontSize / 18));
      var data = off.getImageData(0, 0, w, h).data;
      var points = [];
      for (var y = 0; y < h; y += step) {
        for (var x = 0; x < w; x += step) {
          var idx = (y * w + x) * 4 + 3;
          if (data[idx] > 150) {
            var clampedX = Math.max(margin, Math.min(w - margin, x));
            var clampedY = Math.max(margin, Math.min(h - margin, y));
            points.push({ x: clampedX, y: clampedY });
          }
        }
      }
      if (!points.length) return;
      points.sort(function(a, b){ return a.x === b.x ? a.y - b.y : a.x - b.x; });
      textParticles = [];
      var total = points.length;
      var totalWriteTime = 2600;
      var startTime = now();
      for (var i2 = 0; i2 < points.length; i2++) {
        var p = points[i2];
        var delay = (i2 / total) * totalWriteTime;
        textParticles.push({
          x: w * (0.2 + 0.6 * rnd()),
          y: h + rnd() * 40,
          tx: p.x,
          ty: p.y,
          startTime: startTime + delay,
          duration: 900,
          color: randomColor(),
          done: false,
          seed: rnd()
        });
      }
    }
    function updateTextParticles(t) {
      for (var i = textParticles.length - 1; i >= 0; i--) {
        var p = textParticles[i];
        if (p.done) {
          var tw = (Math.sin((t * 0.001 + p.seed * 2) * 2 * Math.PI * 0.12) + 1) * 0.5; // ‰ΩéÈ¢ëÈó™ÁÉÅ
          var baseAlpha = 0.75;
          var alpha = baseAlpha + tw * 0.25;
          var radius = 1.3 + tw * 0.4;
          ctx.globalAlpha = alpha;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.tx, p.ty, radius, 0, Math.PI * 2);
          ctx.fill();
          ctx.globalAlpha = 1;
          continue;
        }
        var dt = (t - p.startTime) / p.duration;
        if (dt < 0) continue;
        if (dt >= 1) {
          p.done = true;
          p.x = p.tx;
          p.y = p.ty;
          ctx.globalAlpha = 1;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, 1.6, 0, Math.PI * 2);
          ctx.fill();
          continue;
        }
        var ease = dt;
        p.x = p.x + (p.tx - p.x) * ease;
        p.y = p.y + (p.ty - p.y) * ease;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 1.6, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    function tick() {
      var t = now();
      var w = canvas.width / dpr;
      var h = canvas.height / dpr;
      ctx.fillStyle = "rgba(0, 0, 0, 0.2)";
      ctx.fillRect(0, 0, w, h);
      if (t - lastLaunch > 700 + rnd() * 600) {
        spawnFirework();
        lastLaunch = t;
      }
      for (var i = fireworks.length - 1; i >= 0; i--) {
        var fw = fireworks[i];
        fw.y -= fw.speed;
        ctx.fillStyle = fw.color;
        ctx.beginPath();
        ctx.arc(fw.x, fw.y, 2.5, 0, Math.PI * 2);
        ctx.fill();
        if (!fw.exploded && fw.y <= fw.targetY) {
          fw.exploded = true;
          explode(fw);
          fireworks.splice(i, 1);
        }
      }
      for (var j = particles.length - 1; j >= 0; j--) {
        var p = particles[j];
        p.x += p.vx;
        p.y += p.vy;
        p.vy += 0.02;
        p.alpha -= 1 / p.life;
        if (p.alpha <= 0) {
          particles.splice(j, 1);
          continue;
        }
        ctx.globalAlpha = p.alpha;
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
        ctx.fill();
        ctx.globalAlpha = 1;
      }
      if (textParticles.length) updateTextParticles(t);
      requestAnimationFrame(tick);
    }
    function bindControls() {
      var input = document.getElementById("textInput");
      var button = document.getElementById("launchButton");
      if (!input || !button) return;
      function trigger() {
        var value = input.value.trim();
        if (!value) value = input.getAttribute("placeholder") || "";
        createText(value);
      }
      button.addEventListener("click", trigger);
      input.addEventListener("keydown", function(e) {
        if (e.key === "Enter" || e.keyCode === 13) trigger();
      });
      var settingsToggle = document.getElementById("settingsToggle");
      var settingsPanel = document.getElementById("settingsPanel");
      var speedRange = document.getElementById("speedRange");
      var speedLabel = document.getElementById("speedLabel");
      var colorPalette = document.getElementById("colorPalette");
      var shapeInputs = document.querySelectorAll('input[name="shape"]');
      function setPanelVisible(visible) {
        settingsPanel.style.display = visible ? "block" : "none";
      }
      settingsToggle.addEventListener("click", function() {
        var visible = settingsPanel.style.display !== "block";
        setPanelVisible(visible);
      });
      document.addEventListener("click", function(e) {
        var within = settingsPanel.contains(e.target) || settingsToggle.contains(e.target);
        if (!within) setPanelVisible(false);
      });
      speedRange.addEventListener("input", function() {
        var val = Number(speedRange.value) / 100;
        config.speed = Math.max(0.3, Math.min(2.0, val));
        speedLabel.textContent = "x" + config.speed.toFixed(2);
      });
      function updateSelectedColors() {
        var chips = colorPalette.querySelectorAll(".chip.selected");
        config.selectedColors = Array.prototype.map.call(chips, function(el){ return el.getAttribute("data-color"); });
      }
      colorPalette.addEventListener("click", function(e) {
        var target = e.target;
        if (!target.classList.contains("chip")) return;
        target.classList.toggle("selected");
        updateSelectedColors();
      });
      updateSelectedColors();
      shapeInputs.forEach(function(radio){
        radio.addEventListener("change", function() {
          if (radio.checked) config.shape = radio.value;
        });
      });
    }
    window.addEventListener("resize", resize);
    resize();
    bindControls();
    tick();
  })();
  </script>
</body>
</html>
